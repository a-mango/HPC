--------------------------------------------------------------------------------
Profile data file '/home/acm/Documents/heig/HPC/lab/dtmf/code/reports/valgrind/dtmf_encdec-enc_callgrind.out' (creator: callgrind-3.25.0)
--------------------------------------------------------------------------------
I1 cache: 
D1 cache: 
LL cache: 
Timerange: Basic block 0 - 456532007
Trigger: Program termination
Profiled target:  /home/acm/Documents/heig/HPC/lab/dtmf/code/bin/dtmf_encdec-enc encode input.txt output.wav (PID 815867, part 1)
Events recorded:  Ir
Events shown:     Ir
Event sort order: Ir
Thresholds:       99
Include dirs:     
User annotated:   
Auto-annotation:  on

--------------------------------------------------------------------------------
Ir                   
--------------------------------------------------------------------------------
551,888,792 (100.0%)  PROGRAM TOTALS

--------------------------------------------------------------------------------
Ir                    file:function
--------------------------------------------------------------------------------
401,073,806 (72.67%)  /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:__memcpy_avx_unaligned_erms [/usr/lib64/libc.so.6]
100,125,595 (18.14%)  /usr/src/debug/libsndfile-1.2.2-8.fc42.x86_64/src/double64.c:double64_peak_update [/usr/lib64/libsndfile.so.1.0.37]
 26,705,940 ( 4.84%)  /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:__memset_avx2_unaligned_erms [/usr/lib64/libc.so.6]
 18,098,227 ( 3.28%)  /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c:__sin_fma [/usr/lib64/libm.so.6]
  2,434,516 ( 0.44%)  src/lib/dtmf_common.c:_dtmf_gen_tone [/home/acm/Documents/heig/HPC/lab/dtmf/code/bin/dtmf_encdec-enc]

--------------------------------------------------------------------------------
-- Auto-annotated source: src/lib/dtmf_common.c
--------------------------------------------------------------------------------
Ir               

-- line 87 ----------------------------------------
      .           int dtmf_table_size = sizeof(dtmf_table_global) / sizeof(dtmf_table_global[0]);
      .           
      .           DtmfTone dtmf_tones_map_global[DTMF_NUM_TONES];
      .           
      .           static bool dtmf_initialized       = false;
      .           static bool dtmf_table_initialized = false;
      .           static bool dtmf_tones_initialized = false;
      .           
     96 ( 0.00%)  void _dtmf_gen_tone(DtmfFrequencyPair const frequencies, dtmf_float_t *buffer) {
      .               assert(buffer != NULL);
      .           
      .               LIKWID_MARKER_START("encode-tone-gen");
      .           
317,568 ( 0.06%)      for (size_t n = 0; n < DTMF_TONE_NUM_SAMPLES; n++) {
635,040 ( 0.12%)          dtmf_float_t t = (dtmf_float_t)n / (dtmf_float_t)DTMF_SAMPLE_RATE_HZ;
      .           
952,564 ( 0.17%)          buffer[n] = (DTMF_AMPLITUDE) * (sin(2 * M_PI * frequencies.low * t) +
10,106,427 ( 1.83%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c:__sin_fma (105,840x)
    682 ( 0.00%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/elf/../sysdeps/x86_64/dl-trampoline.h:_dl_runtime_resolve_xsave (1x)
529,200 ( 0.10%)                                          sin(2 * M_PI * frequencies.high * t));
10,108,528 ( 1.83%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c:__sin_fma (105,840x)
      .               }
      .           
      .               LIKWID_MARKER_STOP("encode-tone-gen");
     48 ( 0.00%)  }
      .           
      1 ( 0.00%)  void _dtmf_init_tones_map() {
      2 ( 0.00%)      if (dtmf_tones_initialized) {
      .                   return;
      .               }
      .           
      .               // Pass the frequency pairs from frequency map to the generator function.
     40 ( 0.00%)      for (int i = 0; i < DTMF_NUM_TONES; i++) {
     84 ( 0.00%)          _dtmf_gen_tone(DTMF_FREQUENCIES_MAP[i], dtmf_tones_map_global[i].samples);
22,650,153 ( 4.10%)  => src/lib/dtmf_common.c:_dtmf_gen_tone (12x)
      .               }
      .           
      1 ( 0.00%)      dtmf_tones_initialized = true;
      .               debug_printf("Tones map initialized");
      2 ( 0.00%)  }
      .           
      5 ( 0.00%)  void _dtmf_init_table() {
      2 ( 0.00%)      if (dtmf_table_initialized) {
      .                   return;
      .               }
      .           
    145 ( 0.00%)      for (int i = 0; i < dtmf_table_size; i++) {
      .                   DtmfMapping *mapping = &dtmf_table_global[i];
      .           
     47 ( 0.00%)          dtmf_count_t  buffer_write_ptr = 0;
    329 ( 0.00%)          dtmf_float_t *buffer_src       = dtmf_tones_map_global[mapping->key - 1].samples;
     47 ( 0.00%)          dtmf_float_t *buffer_dest      = mapping->tone.samples;
      .           
      .                   assert(buffer_dest != NULL);
      .           
  1,197 ( 0.00%)          for (int j = 0; j < mapping->presses; j++) {
      .                       // Copy the tone samples.
    624 ( 0.00%)              memcpy(buffer_dest + buffer_write_ptr, buffer_src, DTMF_TONE_NUM_SAMPLES * sizeof(dtmf_float_t));
8,750,112 ( 1.59%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:__memcpy_avx_unaligned_erms (124x)
    923 ( 0.00%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/elf/../sysdeps/x86_64/dl-trampoline.h:_dl_runtime_resolve_xsave (1x)
    124 ( 0.00%)              buffer_write_ptr += DTMF_TONE_NUM_SAMPLES;
      .           
      .                       // Add silence between tone repeats.
  1,068 ( 0.00%)              if (mapping->presses > 1 && j < mapping->presses - 1) {
    389 ( 0.00%)                  memset(buffer_dest + buffer_write_ptr, 0, DTMF_TONE_REPEAT_NUM_SAMPLES * sizeof(dtmf_float_t));
1,359,743 ( 0.25%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:__memset_avx2_unaligned_erms (77x)
    786 ( 0.00%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/elf/../sysdeps/x86_64/dl-trampoline.h:_dl_runtime_resolve_xsave (1x)
    154 ( 0.00%)                  buffer_write_ptr += DTMF_TONE_REPEAT_NUM_SAMPLES;
      .                       }
      .                   }
      .           
    141 ( 0.00%)          mapping->tone.sample_count = buffer_write_ptr;
      .               }
      .           
      1 ( 0.00%)      dtmf_table_initialized = true;
      .               debug_printf("Mappings table initialized");
      6 ( 0.00%)  }
      .           
      1 ( 0.00%)  void _dtmf_init() {
      2 ( 0.00%)      if (dtmf_initialized) {
      .                   return;
      .               }
      .           
      1 ( 0.00%)      _dtmf_init_tones_map();
22,650,283 ( 4.10%)  => src/lib/dtmf_common.c:_dtmf_init_tones_map (1x)
      1 ( 0.00%)      _dtmf_init_table();
10,115,843 ( 1.83%)  => src/lib/dtmf_common.c:_dtmf_init_table (1x)
      .           
      1 ( 0.00%)      dtmf_initialized = true;
      .           
      .               debug_printf("DTMF module initialized");
      2 ( 0.00%)  }
      .           
      5 ( 0.00%)  bool _dtmf_allocate_buffer(dtmf_float_t **buffer, size_t num_samples) {
      .               DTMF_TRACE("Allocating buffer of size %lu\n", num_samples);
      .               assert(buffer != NULL);
      .           
      8 ( 0.00%)      *buffer = (dtmf_float_t *)malloc(num_samples * sizeof(dtmf_float_t));
    762 ( 0.00%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/elf/../sysdeps/x86_64/dl-trampoline.h:_dl_runtime_resolve_xsave (1x)
    438 ( 0.00%)  => /usr/src/debug/glibc-2.41-5.fc42.x86_64/malloc/malloc.c:malloc (1x)
      .           
      2 ( 0.00%)      if (*buffer == NULL) {
      .                   DTMF_ERROR("Could not allocate buffer of size %lu", num_samples);
      .               }
      .           
      .               DTMF_TRACE("Allocated buffer of size %lu x %lu bytes", num_samples, sizeof(dtmf_float_t));
      .           
      1 ( 0.00%)      DTMF_SUCCEED();
      4 ( 0.00%)  }
      .           
      .           bool _dtmf_free_buffer(dtmf_float_t *buffer) {
      .               assert(buffer != NULL);
      .           
      .               if (buffer != NULL) {
      .                   free(buffer);
      .                   buffer = NULL;
      .                   return true;
-- line 191 ----------------------------------------

--------------------------------------------------------------------------------
The following files chosen for auto-annotation could not be found:
--------------------------------------------------------------------------------
  /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c
  /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S
  /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S
  /usr/src/debug/libsndfile-1.2.2-8.fc42.x86_64/src/double64.c

--------------------------------------------------------------------------------
Ir                 
--------------------------------------------------------------------------------
2,438,953 ( 0.44%)  events annotated

