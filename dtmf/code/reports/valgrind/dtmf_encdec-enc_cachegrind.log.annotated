--------------------------------------------------------------------------------
-- Metadata
--------------------------------------------------------------------------------
Invocation:       /usr/bin/cg_annotate /home/acm/Documents/heig/HPC/lab/dtmf/code/reports/valgrind/dtmf_encdec-enc_cachegrind.out
Command:          /home/acm/Documents/heig/HPC/lab/dtmf/code/bin/dtmf_encdec-enc encode input.txt output.wav
Events recorded:  Ir
Events shown:     Ir
Event sort order: Ir
Threshold:        0.1%
Annotation:       on

--------------------------------------------------------------------------------
-- Summary
--------------------------------------------------------------------------------
Ir__________________ 

551,893,728 (100.0%)  PROGRAM TOTALS

--------------------------------------------------------------------------------
-- File:function summary
--------------------------------------------------------------------------------
  Ir________________________  file:function

< 401,074,831 (72.7%, 72.7%)  /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:
  401,073,806 (72.7%)           __memcpy_avx_unaligned_erms

< 100,125,683 (18.1%, 90.8%)  /usr/src/debug/libsndfile-1.2.2-8.fc42.x86_64/src/double64.c:
  100,125,595 (18.1%)           double64_peak_update

<  26,705,958  (4.8%, 95.7%)  /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:
   26,705,951  (4.8%)           __memset_avx2_unaligned_erms

<  18,098,227  (3.3%, 98.9%)  /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c:__sin_fma

<   2,227,055  (0.4%, 99.3%)  /home/acm/Documents/heig/HPC/lab/dtmf/code/src/lib/dtmf_common.c:
    2,222,832  (0.4%)           _dtmf_gen_tone

<   2,116,728  (0.4%, 99.7%)  /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/x86/fpu/fenv_private.h:__sin_fma

--------------------------------------------------------------------------------
-- Function:file summary
--------------------------------------------------------------------------------
  Ir________________________  function:file

> 401,073,806 (72.7%, 72.7%)  __memcpy_avx_unaligned_erms:/usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S

> 100,125,595 (18.1%, 90.8%)  double64_peak_update:/usr/src/debug/libsndfile-1.2.2-8.fc42.x86_64/src/double64.c

>  26,705,951  (4.8%, 95.7%)  __memset_avx2_unaligned_erms:/usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S

>  20,214,955  (3.7%, 99.3%)  __sin_fma:
   18,098,227  (3.3%)           /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c
    2,116,728  (0.4%)           /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/x86/fpu/fenv_private.h

>   2,222,832  (0.4%, 99.7%)  _dtmf_gen_tone:/home/acm/Documents/heig/HPC/lab/dtmf/code/src/lib/dtmf_common.c

--------------------------------------------------------------------------------
-- Annotated source file: /home/acm/Documents/heig/HPC/lab/dtmf/code/src/lib/dtmf_common.c
--------------------------------------------------------------------------------
Ir____________ 

-- line 87 ----------------------------------------
      .         int dtmf_table_size = sizeof(dtmf_table_global) / sizeof(dtmf_table_global[0]);
      .         
      .         DtmfTone dtmf_tones_map_global[DTMF_NUM_TONES];
      .         
      .         static bool dtmf_initialized       = false;
      .         static bool dtmf_table_initialized = false;
      .         static bool dtmf_tones_initialized = false;
      .         
     96 (0.0%)  void _dtmf_gen_tone(DtmfFrequencyPair const frequencies, dtmf_float_t *buffer) {
      .             assert(buffer != NULL);
      .         
      .             LIKWID_MARKER_START("encode-tone-gen");
      .         
317,568 (0.1%)      for (size_t n = 0; n < DTMF_TONE_NUM_SAMPLES; n++) {
635,040 (0.1%)          dtmf_float_t t = (dtmf_float_t)n / (dtmf_float_t)DTMF_SAMPLE_RATE_HZ;
      .         
846,720 (0.2%)          buffer[n] = (DTMF_AMPLITUDE) * (sin(2 * M_PI * frequencies.low * t) +
423,360 (0.1%)                                          sin(2 * M_PI * frequencies.high * t));
      .             }
      .         
      .             LIKWID_MARKER_STOP("encode-tone-gen");
     48 (0.0%)  }
      .         
      1 (0.0%)  void _dtmf_init_tones_map() {
      2 (0.0%)      if (dtmf_tones_initialized) {
      .                 return;
      .             }
      .         
      .             // Pass the frequency pairs from frequency map to the generator function.
     40 (0.0%)      for (int i = 0; i < DTMF_NUM_TONES; i++) {
     84 (0.0%)          _dtmf_gen_tone(DTMF_FREQUENCIES_MAP[i], dtmf_tones_map_global[i].samples);
      .             }
      .         
      1 (0.0%)      dtmf_tones_initialized = true;
      .             debug_printf("Tones map initialized");
      2 (0.0%)  }
      .         
      5 (0.0%)  void _dtmf_init_table() {
      2 (0.0%)      if (dtmf_table_initialized) {
      .                 return;
      .             }
      .         
    145 (0.0%)      for (int i = 0; i < dtmf_table_size; i++) {
      .                 DtmfMapping *mapping = &dtmf_table_global[i];
      .         
     47 (0.0%)          dtmf_count_t  buffer_write_ptr = 0;
    329 (0.0%)          dtmf_float_t *buffer_src       = dtmf_tones_map_global[mapping->key - 1].samples;
     47 (0.0%)          dtmf_float_t *buffer_dest      = mapping->tone.samples;
      .         
      .                 assert(buffer_dest != NULL);
      .         
  1,197 (0.0%)          for (int j = 0; j < mapping->presses; j++) {
      .                     // Copy the tone samples.
    496 (0.0%)              memcpy(buffer_dest + buffer_write_ptr, buffer_src, DTMF_TONE_NUM_SAMPLES * sizeof(dtmf_float_t));
    124 (0.0%)              buffer_write_ptr += DTMF_TONE_NUM_SAMPLES;
      .         
      .                     // Add silence between tone repeats.
  1,068 (0.0%)              if (mapping->presses > 1 && j < mapping->presses - 1) {
    308 (0.0%)                  memset(buffer_dest + buffer_write_ptr, 0, DTMF_TONE_REPEAT_NUM_SAMPLES * sizeof(dtmf_float_t));
    154 (0.0%)                  buffer_write_ptr += DTMF_TONE_REPEAT_NUM_SAMPLES;
      .                     }
      .                 }
      .         
    141 (0.0%)          mapping->tone.sample_count = buffer_write_ptr;
      .             }
      .         
      1 (0.0%)      dtmf_table_initialized = true;
      .             debug_printf("Mappings table initialized");
      6 (0.0%)  }
      .         
      1 (0.0%)  void _dtmf_init() {
      2 (0.0%)      if (dtmf_initialized) {
      .                 return;
      .             }
      .         
      1 (0.0%)      _dtmf_init_tones_map();
      1 (0.0%)      _dtmf_init_table();
      .         
      1 (0.0%)      dtmf_initialized = true;
      .         
      .             debug_printf("DTMF module initialized");
      2 (0.0%)  }
      .         
      5 (0.0%)  bool _dtmf_allocate_buffer(dtmf_float_t **buffer, size_t num_samples) {
      .             DTMF_TRACE("Allocating buffer of size %lu\n", num_samples);
      .             assert(buffer != NULL);
      .         
      3 (0.0%)      *buffer = (dtmf_float_t *)malloc(num_samples * sizeof(dtmf_float_t));
      .         
      2 (0.0%)      if (*buffer == NULL) {
      .                 DTMF_ERROR("Could not allocate buffer of size %lu", num_samples);
      .             }
      .         
      .             DTMF_TRACE("Allocated buffer of size %lu x %lu bytes", num_samples, sizeof(dtmf_float_t));
      .         
      1 (0.0%)      DTMF_SUCCEED();
      4 (0.0%)  }
      .         
      .         bool _dtmf_free_buffer(dtmf_float_t *buffer) {
      .             assert(buffer != NULL);
      .         
      .             if (buffer != NULL) {
      .                 free(buffer);
      .                 buffer = NULL;
      .                 return true;
-- line 191 ----------------------------------------

--------------------------------------------------------------------------------
-- Annotated source file: /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c
--------------------------------------------------------------------------------
Unannotated because one or more of these original files are unreadable:
- /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/ieee754/dbl-64/s_sin.c

--------------------------------------------------------------------------------
-- Annotated source file: /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/x86/fpu/fenv_private.h
--------------------------------------------------------------------------------
Unannotated because one or more of these original files are unreadable:
- /usr/src/debug/glibc-2.41-5.fc42.x86_64/math/../sysdeps/x86/fpu/fenv_private.h

--------------------------------------------------------------------------------
-- Annotated source file: /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S
--------------------------------------------------------------------------------
Unannotated because one or more of these original files are unreadable:
- /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S

--------------------------------------------------------------------------------
-- Annotated source file: /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S
--------------------------------------------------------------------------------
Unannotated because one or more of these original files are unreadable:
- /usr/src/debug/glibc-2.41-5.fc42.x86_64/string/../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S

--------------------------------------------------------------------------------
-- Annotated source file: /usr/src/debug/libsndfile-1.2.2-8.fc42.x86_64/src/double64.c
--------------------------------------------------------------------------------
Unannotated because one or more of these original files are unreadable:
- /usr/src/debug/libsndfile-1.2.2-8.fc42.x86_64/src/double64.c

--------------------------------------------------------------------------------
-- Annotation summary
--------------------------------------------------------------------------------
Ir_________________ 

  2,227,055  (0.4%)    annotated: files known & above threshold & readable, line numbers known
          0            annotated: files known & above threshold & readable, line numbers unknown
          0          unannotated: files known & above threshold & two or more non-identical
548,121,427 (99.3%)  unannotated: files known & above threshold & unreadable 
  1,330,298  (0.2%)  unannotated: files known & below threshold
    214,948  (0.0%)  unannotated: files unknown

